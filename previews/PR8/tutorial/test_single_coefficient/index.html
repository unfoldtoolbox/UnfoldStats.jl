<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Two-stage single parameter test (t-test) · UnfoldStats.jl</title><meta name="title" content="Two-stage single parameter test (t-test) · UnfoldStats.jl"/><meta property="og:title" content="Two-stage single parameter test (t-test) · UnfoldStats.jl"/><meta property="twitter:title" content="Two-stage single parameter test (t-test) · UnfoldStats.jl"/><meta name="description" content="Documentation for UnfoldStats.jl."/><meta property="og:description" content="Documentation for UnfoldStats.jl."/><meta property="twitter:description" content="Documentation for UnfoldStats.jl."/><meta property="og:url" content="https://unfoldtoolbox.github.io/UnfoldStats.jl/tutorial/test_single_coefficient/"/><meta property="twitter:url" content="https://unfoldtoolbox.github.io/UnfoldStats.jl/tutorial/test_single_coefficient/"/><link rel="canonical" href="https://unfoldtoolbox.github.io/UnfoldStats.jl/tutorial/test_single_coefficient/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UnfoldStats.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Two-stage single parameter test (t-test)</a><ul class="internal"><li><a class="tocitem" href="#Clusterdepth"><span>Clusterdepth</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li></ul></li><li><a class="tocitem" href="../../generated/tutorial/test_splines/">Two-stage multi parameter test (Hotelling&#39;s T-squared test)</a></li><li><a class="tocitem" href="../../generated/tutorial/lmm_clusterdepth/"><strong>MixedModels</strong> EEG + Cluster permutation test</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Two-stage single parameter test (t-test)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Two-stage single parameter test (t-test)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/UnfoldStats.jl/blob/main/docs/src/tutorial/test_single_coefficient.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><pre><code class="language-julia hljs">using Random
using CairoMakie
using UnfoldSim
using Unfold
using UnfoldMakie
using Statistics
using ClusterDepth
using DataFrames
using Distributions</code></pre><h1 id="-Unfold-single-parameter-testing"><a class="docs-heading-anchor" href="##-Unfold-single-parameter-testing"># Unfold single parameter testing</a><a id="-Unfold-single-parameter-testing-1"></a><a class="docs-heading-anchor-permalink" href="##-Unfold-single-parameter-testing" title="Permalink"></a></h1><p>This is an adaptation of the <a href="https://www.s-ccs.de/ClusterDepth.jl/dev/tutorials/eeg/">ClusterDepth.jl tutorial</a>.</p><p>Let&#39;s create data from 20 subjects</p><pre><code class="language-julia hljs">n_subjects = 20
data,events = UnfoldSim.predef_eeg(n_subjects;return_epoched=true)
times = range(0,step=1/100,length=size(data,1))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0:0.01:0.44</code></pre><p>Fit an UnfoldModel to each subject</p><pre><code class="language-julia hljs">formula = @formula(0 ~ 1 + condition)
models = map((d, ev) -&gt; (fit(UnfoldModel, formula, DataFrame(ev), collect(d), times), ev.subject[1]),
    eachslice(data; dims=3),
    groupby(events, :subject))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">20-element Vector{Tuple{Unfold.UnfoldLinearModel{Float64}, String}}:
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.03245111327220357 0.04014517725394404 … 0.03600064398766749 0.03889945363509382;;; 0.013568692971134503 0.01828653458375995 … 0.0018772477947043547 -0.02751647266245564], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.03889945363509382, -0.02751647266245564]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S01&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-0.05208874861485672 -0.034441896290149335 … 0.022745438349802312 -0.03739746115171337;;; 0.023879626411259878 0.010875397411674884 … -0.00306288491079342 0.0035044391223840116], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[-0.03739746115171337, 0.0035044391223840116]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S02&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.02013386460700609 0.014031928095407816 … 0.1079098798495964 0.01782632282972976;;; -0.061830229111268765 -0.03928305993567861 … -0.020819359847602678 -0.036008469427761175], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.01782632282972976, -0.036008469427761175]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S03&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.014630057642920687 0.01719236307331667 … 0.095353069663337 0.009384306714609509;;; -0.024927511092378916 -0.009034382436029836 … -0.026392417171550026 -0.0001594174950534143], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.009384306714609509, -0.0001594174950534143]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S04&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.056238182979720074 0.04873287285863117 … 0.04293260584777882 -0.023150418543186644;;; -0.015224911104363494 -0.008188829065384828 … 0.05268354181967752 0.06084260871579378], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[-0.023150418543186644, 0.06084260871579378]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S05&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.02655401113508165 -0.004282604796294919 … 0.10529048437409054 0.028707562672135336;;; -0.01699750506179686 -0.020568060498364335 … -0.02935921735076818 -0.004300265731338857], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.028707562672135336, -0.004300265731338857]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S06&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.1341614463584563 0.1576771544172925 … 0.18144011885132463 0.1078176140196164;;; -0.02842464731551202 -0.046069582911370435 … -0.016550329113674964 0.009946927838922901], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.1078176140196164, 0.009946927838922901]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S07&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-0.05433851078868482 -0.052699620877401133 … 0.022626488165074614 -0.03711436722330136;;; 0.07626299482375871 0.09151537477660175 … 0.0022355986462628367 0.028537829164211173], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[-0.03711436722330136, 0.028537829164211173]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S08&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-0.0563607478439483 -0.041984381741750273 … 0.02994659386800411 -0.039037818730527016;;; -0.024382359945437887 -0.046148286320683234 … -0.007796296146817897 -0.017109861136479936], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[-0.039037818730527016, -0.017109861136479936]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S09&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-0.00329075800835531 -0.007020591488914465 … 0.052754243469444656 -0.03385159958614905;;; -0.019682959600734774 -0.034318627034172475 … -0.02494823514728967 0.009195694094660886], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[-0.03385159958614905, 0.009195694094660886]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S10&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.05777571948813047 0.06553164700750463 … 0.09108534510008388 0.03294390922735818;;; -0.016541071710138945 -0.04382528493495562 … 0.0055762406190666075 -0.017412728178957625], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.03294390922735818, -0.017412728178957625]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S11&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-0.03773879847875383 -0.023634440162394882 … 0.02962926856785197 -0.0033465473956962944;;; 0.0447023720594733 0.02699955628442132 … 0.030116094922156673 -0.013959829501796004], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[-0.0033465473956962944, -0.013959829501796004]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S12&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.027400537693551847 0.026989662139379724 … 0.1018076517840928 0.0400083371371956;;; 0.05959894039614039 0.038047793288438 … -0.0028542380180949798 0.017625345280670283], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.0400083371371956, 0.017625345280670283]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S13&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-0.002965391835447474 -0.007487717562721451 … 0.06057236884800245 0.0025823339563059607;;; 0.07583214583759647 0.03531979848114621 … -0.00030468179982161845 -0.005189705289241976], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.0025823339563059607, -0.005189705289241976]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S14&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.031577159520799536 0.028665031384197612 … 0.08473448483455222 0.07102612084286453;;; 0.050043353473515725 0.045419451167132 … 0.020718919110380082 -0.036532467081081654], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.07102612084286453, -0.036532467081081654]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S15&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.06341949521199172 0.05698299402336783 … 0.12599517666813329 0.06278846036004145;;; -0.02021610499841304 -0.018366423993953437 … -0.016151493870616353 -0.014899317609203742], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.06278846036004145, -0.014899317609203742]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S16&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.02022537154639761 0.029863969737293827 … 0.08377995029147516 0.045467610047072955;;; 0.03075549179225964 -7.902671098785567e-5 … -0.015755417700213367 -0.018993376407616416], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.045467610047072955, -0.018993376407616416]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S17&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.00295186839423454 -0.0018667139273118526 … 0.09442585980115581 0.0417122053307238;;; -0.02147907794584123 -0.007395228214929658 … -0.054839036224028755 -0.04564020429183453], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.0417122053307238, -0.04564020429183453]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S18&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([-2.188176470816995e-6 -0.027691140501471305 … 0.015776368171961135 0.0007958532434337326;;; -0.03825600449586109 -0.0059582897910163395 … -0.008912806549445205 -0.052205281632570134], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.0007958532434337326, -0.052205281632570134]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S19&quot;)
 (Unfold.UnfoldLinearModel{Float64}(╭──────────────────────────────────────────────────────────────────────────────╮
│  Any=&gt;(0 ~ 1 + condition,0.0:0.01:0.44)                                      │
╰──────────────────────────────────────────────────────────────────────────────╯
, Unfold.DesignMatrixLinearModel{Float64}[<span class="sgr38_2" style="color:#ce93d8">::Unfold.DesignMatrixLinearModel 
 @formula: </span><span class="sgr38_2" style="color:#90caf9">1</span> <span class="sgr38_2" style="color:#ef5350">+</span> condition 
  
 <span class="sgr38_2" style="color:#ef5350">-</span> modelmatrix (time<span class="sgr38_2" style="color:#ef5350">/</span>trials x predictors): (<span class="sgr38_2" style="color:#90caf9">100</span>, <span class="sgr38_2" style="color:#90caf9">2</span>) 
 <span class="sgr38_2" style="color:#ef5350">-</span> <span class="sgr38_2" style="color:#90caf9">100</span> events with <span class="sgr38_2" style="color:#90caf9">5</span> columns 
 
useful functions: <span class="sgr38_2" style="color:#ffee58">`formulas(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`modelmatrix(d)</span><span class="sgr38_2" style="color:#ef5350">/</span><span class="sgr38_2" style="color:#ffee58">modelmatrices(d)`</span>, <span class="sgr38_2" style="color:#ffee58">`events(d)`</span> 
 Fields: <span class="sgr38_2" style="color:#ffee58">`.formula`</span>, <span class="sgr38_2" style="color:#ffee58">`.modelmatrix`</span>, <span class="sgr38_2" style="color:#ffee58">`.events`</span> 
 ], Unfold.LinearModelFit{Float64, 3}([0.003555410229540892 -0.020927683889039116 … 0.09170534231555917 0.008128801558598762;;; -0.005277929485337628 0.04271519032374937 … -0.013567412525527726 0.0219556237945105], Vector{Any}[[Unfold.var&quot;#97#98&quot;(), Unfold.solver_pinv!, Any[[0.008128801558598762, 0.0219556237945105]]]], Array{Float64, 3}(undef, 0, 0, 0))), &quot;S20&quot;)</code></pre><p>now we can inspect the data easily, and extract the face-effect</p><pre><code class="language-julia hljs">function add_subject!(df, s)
    df[!, :subject] .= s
    return df
end
allEffects = map((x) -&gt; (effects(Dict(:condition =&gt; [&quot;car&quot;, &quot;face&quot;]), x[1]), x[2]) |&gt; (x) -&gt; add_subject!(x[1], x[2]), models) |&gt; e -&gt; reduce(vcat, e)

plot_erp(allEffects; mapping=(color=:condition, group=:subject))</code></pre><img src="4823211f.png" alt="Example block output"/><p>extract the face-coefficient from the linear model</p><pre><code class="language-julia hljs">allCoefs = map(m -&gt; (coeftable(m[1]), m[2]) |&gt; (x) -&gt; add_subject!(x[1], x[2]), models) |&gt; e -&gt; reduce(vcat, e)
plot_erp(allCoefs; mapping=(group=:subject, col=:coefname))</code></pre><img src="6ad489bb.png" alt="Example block output"/><p>let&#39;s unstack the tidy-coef table into a matrix and put it to clusterdepth for clusterpermutation testing</p><pre><code class="language-julia hljs">faceCoefs = allCoefs |&gt; x -&gt; subset(x, :coefname =&gt; x -&gt; x .== &quot;condition: face&quot;)
erpMatrix = unstack(faceCoefs, :subject, :time, :estimate) |&gt; x -&gt; Matrix(x[:, 2:end])&#39; |&gt; collect
summary(erpMatrix)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;45×20 Matrix{Union{Missing, Float64}}&quot;</code></pre><h2 id="Clusterdepth"><a class="docs-heading-anchor" href="#Clusterdepth">Clusterdepth</a><a id="Clusterdepth-1"></a><a class="docs-heading-anchor-permalink" href="#Clusterdepth" title="Permalink"></a></h2><pre><code class="language-julia hljs">pvals = clusterdepth(erpMatrix; τ=quantile(TDist(n_subjects - 1), 0.95), nperm=5000);</code></pre><p>well - that was fast, less than a second for a cluster permutation test. not bad at all!</p><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>Some plotting, and we add the identified cluster</p><p>first calculate the ERP</p><pre><code class="language-julia hljs">faceERP = groupby(faceCoefs, [:time, :coefname]) |&gt;
          x -&gt; combine(x, :estimate =&gt; mean =&gt; :estimate,
    :estimate =&gt; std =&gt; :stderror);</code></pre><p>put the pvalues into a nicer format</p><pre><code class="language-julia hljs">pvalDF = ClusterDepth.cluster(pvals .&lt;= 0.05) |&gt; x -&gt; DataFrame(:from =&gt; x[1] ./ 250, :to =&gt; (x[1] .+ x[2]) ./ 250, :coefname =&gt; &quot;condition: face&quot;)
plot_erp(faceERP; stderror=true, significance=pvalDF)</code></pre><img src="95698802.png" alt="Example block output"/><p>Looks good to me! We identified the cluster :-)</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../generated/tutorial/test_splines/">Two-stage multi parameter test (Hotelling&#39;s T-squared test) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 13 February 2025 16:23">Thursday 13 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
