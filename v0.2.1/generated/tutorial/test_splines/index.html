<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Two-stage multi parameter test (Hotelling&#39;s T-squared test) · UnfoldStats.jl</title><meta name="title" content="Two-stage multi parameter test (Hotelling&#39;s T-squared test) · UnfoldStats.jl"/><meta property="og:title" content="Two-stage multi parameter test (Hotelling&#39;s T-squared test) · UnfoldStats.jl"/><meta property="twitter:title" content="Two-stage multi parameter test (Hotelling&#39;s T-squared test) · UnfoldStats.jl"/><meta name="description" content="Documentation for UnfoldStats.jl."/><meta property="og:description" content="Documentation for UnfoldStats.jl."/><meta property="twitter:description" content="Documentation for UnfoldStats.jl."/><meta property="og:url" content="https://unfoldtoolbox.github.io/UnfoldStats.jl/generated/tutorial/test_splines/"/><meta property="twitter:url" content="https://unfoldtoolbox.github.io/UnfoldStats.jl/generated/tutorial/test_splines/"/><link rel="canonical" href="https://unfoldtoolbox.github.io/UnfoldStats.jl/generated/tutorial/test_splines/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">UnfoldStats.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../../tutorial/test_single_coefficient/">Two-stage single parameter test (t-test)</a></li><li class="is-active"><a class="tocitem" href>Two-stage multi parameter test (Hotelling&#39;s T-squared test)</a><ul class="internal"><li><a class="tocitem" href="#0.-Setup"><span>0. Setup</span></a></li><li><a class="tocitem" href="#1.-Simulate-data"><span>1. Simulate data</span></a></li><li><a class="tocitem" href="#2.-Fit-an-Unfold-model-for-each-subject-(first-stage)"><span>2. Fit an Unfold model for each subject (first stage)</span></a></li><li><a class="tocitem" href="#3.-Compute-and-visualize-the-marginal-effects"><span>3. Compute and visualize the marginal effects</span></a></li><li><a class="tocitem" href="#4.-Extract-coefficients-and-conduct-Hotelling&#39;s-T-tests"><span>4. Extract coefficients &amp; conduct Hotelling&#39;s T² tests</span></a></li></ul></li><li><a class="tocitem" href="../lmm_clusterdepth/"><strong>MixedModels</strong> EEG + Cluster permutation test</a></li></ul></li><li><a class="tocitem" href="../../../api/">API / Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Two-stage multi parameter test (Hotelling&#39;s T-squared test)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Two-stage multi parameter test (Hotelling&#39;s T-squared test)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/UnfoldStats.jl/blob/main/docs/literate/tutorial/test_splines.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Two-stage-EEG-analysis-using-Unfold-and-UnfoldStats"><a class="docs-heading-anchor" href="#Two-stage-EEG-analysis-using-Unfold-and-UnfoldStats">Two-stage EEG analysis using Unfold &amp; UnfoldStats</a><a id="Two-stage-EEG-analysis-using-Unfold-and-UnfoldStats-1"></a><a class="docs-heading-anchor-permalink" href="#Two-stage-EEG-analysis-using-Unfold-and-UnfoldStats" title="Permalink"></a></h1><h2 id="0.-Setup"><a class="docs-heading-anchor" href="#0.-Setup">0. Setup</a><a id="0.-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#0.-Setup" title="Permalink"></a></h2><p>Load required packages.</p><pre><code class="language-julia hljs">using UnfoldStats
using Unfold
using DataFrames
using Chain
using Statistics
using HypothesisTests
using CairoMakie
using UnfoldMakie</code></pre><h2 id="1.-Simulate-data"><a class="docs-heading-anchor" href="#1.-Simulate-data">1. Simulate data</a><a id="1.-Simulate-data-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Simulate-data" title="Permalink"></a></h2><p>This section can be skipped, if one already has (real) data that they want to analyse.</p><details>
<summary>Click to expand the simulation details</summary><pre><code class="language-julia hljs">using UnfoldSim
using StableRNGs

design = MultiSubjectDesign(
    n_subjects = 20,
    n_items = 100,
    items_between = Dict(:continuous =&gt; range(0, 2, length = 10)),
)

β = [1, 1, 0.5, 0.2]
σs = Dict(:subject =&gt; [1, 0.1, 0.1, 0.1])

signal = MixedModelComponent(;
    basis = UnfoldSim.hanning(50),
    formula = @formula(
        0 ~
            1 +
            continuous +
            continuous^2 +
            continuous^3 +
            (1 + continuous + continuous^2 + continuous^3 | subject)
    ),
    β = β,
    σs = σs,
)

hart = Hartmut()
signal_multichannel = MultichannelComponent(signal, hart =&gt; &quot;Left Postcentral Gyrus&quot;)

onset = UniformOnset(; width = 50, offset = 60)
noise = PinkNoise(; noiselevel = 5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">UnfoldSim.PinkNoise
  noiselevel: Int64 5
  func: UnionAll
</code></pre></details ><pre><code class="language-julia hljs">data, events = UnfoldSim.simulate(
    StableRNG(1),
    design,
    signal_multichannel,
    onset,
    noise,
    return_epoched = false,
);</code></pre><details>
<summary>Click to expand event data frame </summary><pre><code class="language-julia hljs">first(events, 12)</code></pre><div><div style = "float: left;"><span>12×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">subject</th><th style = "text-align: left;">item</th><th style = "text-align: left;">continuous</th><th style = "text-align: left;">latency</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I001</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">80</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I002</td><td style = "text-align: right;">0.222222</td><td style = "text-align: right;">190</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I003</td><td style = "text-align: right;">0.444444</td><td style = "text-align: right;">277</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I004</td><td style = "text-align: right;">0.666667</td><td style = "text-align: right;">350</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I005</td><td style = "text-align: right;">0.888889</td><td style = "text-align: right;">450</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I006</td><td style = "text-align: right;">1.11111</td><td style = "text-align: right;">542</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I007</td><td style = "text-align: right;">1.33333</td><td style = "text-align: right;">626</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I008</td><td style = "text-align: right;">1.55556</td><td style = "text-align: right;">736</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I009</td><td style = "text-align: right;">1.77778</td><td style = "text-align: right;">813</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I010</td><td style = "text-align: right;">2.0</td><td style = "text-align: right;">921</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I011</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">986</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I012</td><td style = "text-align: right;">0.222222</td><td style = "text-align: right;">1090</td></tr></tbody></table></div></details ><h2 id="2.-Fit-an-Unfold-model-for-each-subject-(first-stage)"><a class="docs-heading-anchor" href="#2.-Fit-an-Unfold-model-for-each-subject-(first-stage)">2. Fit an Unfold model for each subject (first stage)</a><a id="2.-Fit-an-Unfold-model-for-each-subject-(first-stage)-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Fit-an-Unfold-model-for-each-subject-(first-stage)" title="Permalink"></a></h2><p>In the first stage, we fit an Unfold model for each subject separately.</p><pre><code class="language-julia hljs"># Specify a temporal basis function
basisfunction = firbasis((-0.1, 0.7), 100)

# Specify the model formula
formula = @formula 0 ~ 1 + spl(continuous, 4)

# Combine basisfunction and formula in an event dict
event_vec = [Any =&gt; (formula, basisfunction)]

subject_list = unique(events.subject)
model_list = UnfoldLinearModelContinuousTime[]

# Slice the data by its last dimension (i.e. the subject dimension)
data_slices = eachslice(data, dims = ndims(data))

for s = 1:size(data, ndims(data))
    m = fit(
        UnfoldModel,
        event_vec,
        subset(events, :subject =&gt; ByRow(==(subject_list[s]))),
        data_slices[s],
    )
    push!(model_list, m)
end

models = DataFrame(subject = subject_list, unfoldmodel = model_list);
size(models)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(20, 2)</code></pre><p>As a result, we get a dataframe which contains an Unfold model for each subject.</p><h2 id="3.-Compute-and-visualize-the-marginal-effects"><a class="docs-heading-anchor" href="#3.-Compute-and-visualize-the-marginal-effects">3. Compute and visualize the marginal effects</a><a id="3.-Compute-and-visualize-the-marginal-effects-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Compute-and-visualize-the-marginal-effects" title="Permalink"></a></h2><p>In the next step, we will compute the marginal effects of the <code>continuous</code> predictor i.e. how the prediction changes for different levels of this predictor. First, we compute the marginal effects separately for each subject. Then we aggregate them over subjects using the <code>mean</code>.</p><pre><code class="language-julia hljs"># Specify the predictors of interest
predictor_dict = Dict(:continuous =&gt; range(0, 2, length = 3))

# Compute the marginal effects for all subjects separately
effects_all_subjects = combine(
    groupby(models, :subject),
    :unfoldmodel =&gt; (m -&gt; effects(predictor_dict, m[1])) =&gt; AsTable,
)

# Aggregate the marginal effects (per event type, time point and channel) over subjects
# using the mean as aggregation function
aggregated_effects = @chain effects_all_subjects begin
    groupby([:eventname, :channel, collect(keys(predictor_dict))..., :time])
    combine(:yhat .=&gt; [x -&gt; mean(skipmissing(x))] .=&gt; Symbol(&quot;yhat_&quot;, mean))
end;
first(aggregated_effects, 5)</code></pre><div><div style = "float: left;"><span>5×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">eventname</th><th style = "text-align: left;">channel</th><th style = "text-align: left;">continuous</th><th style = "text-align: left;">time</th><th style = "text-align: left;">yhat_mean</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "DataType" style = "text-align: left;">DataType</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Any</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.142467</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Any</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.00223103</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Any</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.0174379</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">Any</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.133778</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">Any</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.281127</td></tr></tbody></table></div><p>Next, we want to visualize the marginal effects in a topoplot series. For this we first need to extract the electrode positions for our simulated data (or your real data) and project them from 3d to 2d.</p><pre><code class="language-julia hljs"># Extract the electrode positions for the simulated data from the headmodel
# and project them from 3d to 2d.
pos3d = hart.electrodes[&quot;pos&quot;];
pos2d = to_positions(pos3d&#39;)
pos2d = [Point2f(p[1] + 0.5, p[2] + 0.5) for p in pos2d];</code></pre><p>For visualization, we use the <a href="https://unfoldtoolbox.github.io/UnfoldMakie.jl/dev/generated/tutorials/topoplotseries/"><code>plot_topoplotseries</code> function</a> from <code>UnfoldMakie</code>. In the topoplot series, the time in seconds (binned in time windows) is represented from left to right. The rows (from top to bottom) represent the marginal effects for different levels of the predictor <code>continuous</code>.</p><pre><code class="language-julia hljs"># Set the size of the time bins for the topoplot series
bin_width = 0.1
aggregated_effects.estimate = aggregated_effects.yhat_mean # bug in UnfoldMakie 0.5.12
f_effects = Figure(size = (1200, 600))
tp_effects = plot_topoplotseries!(
    f_effects,
    aggregated_effects;
    bin_width,
    positions = pos2d,
    mapping = (; y = :estimate, row = :continuous),
    visual = (; enlarge = 0.6, label_scatter = false, colorrange = (-3, 3)),
)

ax = current_axis()
linkaxes!(tp_effects.content[1:end-2]...)
xlims!(ax, 0, 0.9)
ylims!(ax, 0, 0.9)
current_figure()</code></pre><img src="8398182f.png" alt="Example block output"/><p>In the time windows <code>[0.1, 0.2)</code>, <code>[0.2, 0.3)</code> and <code>[0.3, 0.4)</code>, one can see the effect of <code>continuous</code> that we simulated. In the next section, we want to quantify and test this effect.</p><h2 id="4.-Extract-coefficients-and-conduct-Hotelling&#39;s-T-tests"><a class="docs-heading-anchor" href="#4.-Extract-coefficients-and-conduct-Hotelling&#39;s-T-tests">4. Extract coefficients &amp; conduct Hotelling&#39;s T² tests</a><a id="4.-Extract-coefficients-and-conduct-Hotelling&#39;s-T-tests-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Extract-coefficients-and-conduct-Hotelling&#39;s-T-tests" title="Permalink"></a></h2><p>We will use a one-sample Hotelling&#39;s T² test to test whether at least one of the spline coefficients is different from 0. First, we extract the spline coefficients (for the <code>continuous</code> predictor variable) for all subjects. Then we conduct a Hotelling&#39;s T² test separately for each channel and time point and extract the correspoding p-value.</p><pre><code class="language-julia hljs"># Extract the spline coefficients for the `continuous` predictor variable
# from the Unfold models of all subjects
eventname = unique(effects_all_subjects.eventname)
coefs = extract_coefs(models.unfoldmodel, :continuous, eventname)

# Conduct a one-sample Hotelling&#39;s T² test separately for all channels and time points
# and compute a p-value. We compare the spline coefficients vector against 0.
p_values =
    mapslices(c -&gt; pvalue(OneSampleHotellingT2Test(c&#39;, [0, 0, 0])), coefs, dims = (3, 4)) |&gt;
    x -&gt; dropdims(x, dims = (3, 4));

times = unique(effects_all_subjects.time)
channels = axes(p_values, 1)

# For visualization purposes, save the p_values in a data frame together with time and channel
p_values_df = DataFrame(
    channel = repeat(channels, outer = length(times)),
    time = repeat(times, inner = length(channels)),
    p_values = p_values[:],
);

first(p_values_df, 5)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">channel</th><th style = "text-align: left;">time</th><th style = "text-align: left;">p_values</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.731021</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.411405</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.212582</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.0953801</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">-0.1</td><td style = "text-align: right;">0.397495</td></tr></tbody></table></div><p>As a last step, we visualize the p-values in a topoplot series.</p><pre><code class="language-julia hljs">bin_width = 0.1
p_values_df.estimate = p_values_df.p_values
f_pvalues = Figure(size = (1200, 200))
tp_pvalues = plot_topoplotseries!(
    f_pvalues,
    p_values_df;
    bin_width,
    positions = pos2d,
    mapping = (; y = :estimate),
    visual = (;
        enlarge = 0.6,
        label_scatter = false,
        colorrange = (0, 0.1),
        colormap = :Reds,
    ),
    colorbar = (; label = &quot;p-value&quot;, limits = (0, 0.1), ticks = ([0.0, 0.1], [&quot;0&quot;, &quot;0.1&quot;])),
)

ax = current_axis()
current_figure()</code></pre><img src="768b50cf.png" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To decide whether to consider the effect statistically significant and to correct for multiple comparisons (due to different time points and channels), one could conduct a cluster-permutation test using the Hotelling&#39;s T² values as the test statistic.</p></div></div><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../tutorial/test_single_coefficient/">« Two-stage single parameter test (t-test)</a><a class="docs-footer-nextpage" href="../lmm_clusterdepth/"><strong>MixedModels</strong> EEG + Cluster permutation test »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 23 April 2025 14:53">Wednesday 23 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
